# Claude Code 実行指示

## タスク実行時の作業工程確認

タスクを実行する際は、以下の手順を必ず実行してください：

### セッション開始時の必須チェック

1. **memo.logファイルの確認**: 作業再開時は必ずmemo.logファイルを読み込み、以下を把握する
   - 前回までの作業完了状況
   - 現在進行中のタスクとその詳細
   - 未完了タスクの優先順位
   - 品質基準と完了条件
   - 前回発見された課題や注意事項

2. **TodoReadツールとの同期確認**: memo.logの内容とTodoReadツールの状態を照合し、齟齬がないか確認する

### タスク実行手順

3. **プロンプト解釈**: ユーザーの指示を理解し、memo.logの文脈と照らし合わせて明確なプロンプトに変換・整理する
4. **作業工程の列挙**: TodoWriteツールを使用して、タスクを細かい作業工程に分解し、やるべきことを明確にリストアップする
5. **過不足の確認**: 列挙した工程が完了目標を達成するために十分かつ適切かを確認する
6. **順序の確認**: 作業工程の実行順序が論理的で効率的かを確認する
7. **着手**: 確認完了後、計画に従って順次実行する
8. **進捗管理**: 各工程の完了時にTodoWriteツールでステータスを更新する

### セッション終了時の必須作業

9. **memo.logの更新**: セッション終了時は必ずmemo.logファイルを更新し、以下を記録する
   - 完了したタスクの詳細とタイムスタンプ
   - 進行中タスクの現在状況
   - 次回セッションでの優先作業

10. **CLAUDE.mdの継続的改善**: タスク実行中に発見した改善点は**即座にCLAUDE.mdに反映**する
    - 効率化できる手順やツールの使用方法
    - 新たに発見したベストプラクティス
    - エラーや問題の回避方法
    - より良いプロセスや品質基準
    - 他のプロジェクトでも活用できる知見

**重要**: CLAUDE.mdは「生きたドキュメント」として、タスク実行から得られた学びを即座に蓄積し、次回以降の作業効率を継続的に向上させる。改善点を見つけたら「後で記録する」ではなく、**その場で即座に追記**すること。

この手順により、作業の継続性を保ち、タスクの漏れや重複を防ぎ、効率的かつ確実にタスクを完了できます。

## AWS関連タスクの特別指示

AWS関連の指示やタスクについては、以下を必ず実行してください：

1. **MCPサーバの利用**: AWS関連情報が必要な場合は、必ずMCPサーバ（mcp__aws-docs__）を利用して最新の公式ドキュメントを参照する
2. **情報の検索**: `mcp__aws-docs__search_documentation`を使用してAWSサービスの最新情報を検索する
3. **詳細情報の取得**: `mcp__aws-docs__read_documentation`を使用して特定のAWSドキュメントページの詳細を取得する
4. **関連情報の確認**: `mcp__aws-docs__recommend`を使用して関連する最新情報や新機能を確認する

これにより、常に最新かつ正確なAWS情報に基づいてタスクを実行できます。

## 包括的プロジェクト管理プロセス

複数ファイル作成や大規模タスクを扱う際は、以下の段階的プロセスを必ず適用してください：

### Phase 1: Discovery（発見・要件定義）

1. **完全スコープ調査**: タスク開始前に必ず以下を実行する
   - 全関連ファイル・フォルダの包括的スキャン
   - READMEファイルや参照ドキュメントの完全確認
   - 既存ファイルの内容・品質・構造の評価
   - ユーザー要件の明確化と境界設定

2. **品質基準設定**: 作業開始前に以下を明確化する
   - ファイル形式・構造の統一基準
   - 内容の深度・範囲（例：100問、特定技術領域等）
   - 命名規則・参照整合性の要件
   - 完了判定の具体的条件

### Phase 2: Planning（計画・設計）

1. **包括的タスク分解**: TodoWriteツールで以下を実行する
   - 発見したすべての作業を細分化
   - タスク間の依存関係を明確化
   - 各タスクの完了条件を具体的に定義
   - 優先度設定（high/medium/low）と工数見積もり

2. **変更管理プロセス**: 要件変更時の対応手順
   - 既存Todoリストへの影響分析
   - 新規タスクの適切な優先度設定
   - 全体工数・スケジュールの再評価
   - ユーザーへの影響報告

### Phase 3: Execution（実行）

1. **タスクベース実行**: 計画に基づいた順次実行
   - 一度に1つのタスクに集中（ステータス: in_progress）
   - 完了時の即座なステータス更新（completed）
   - 中間成果物の品質確認

2. **継続的検証**: 各段階での確認
   - ファイル存在・内容の検証
   - 参照整合性チェック
   - 品質基準達成度確認

### Phase 4: Validation（検証・完了確認）

1. **最終品質チェック**: 全作業完了前に実行
   - すべての要求ファイルの存在確認
   - 内容品質の基準達成確認
   - リンク・参照の整合性検証

2. **完了報告**: ユーザーへの明確な完了状況報告
   - 作成・更新されたファイル一覧
   - 達成された品質基準の確認
   - 残存課題や推奨事項（もしあれば）

## 不足ファイル問題防止の原則

1. **事前調査の徹底**: 「部分的な作業依頼」でも必ず全体像を把握する
2. **TodoWriteツールの活用**: すべての作業をタスク化し、進捗を可視化する  
3. **段階的拡張の回避**: 要件変更は明示的に管理し、影響範囲を事前評価する
4. **品質基準の一貫性**: 開始時に設定した基準を最後まで維持する

この プロセスにより、繰り返し作業や不足ファイル問題を根本的に防止し、効率的で確実なタスク完了を実現します。

## 作業漏れ防止のための進捗管理ファイル

大規模プロジェクトや複数ファイル作成タスクにおいて、作業漏れを確実に防止するため、以下の進捗管理手法を必ず適用してください：

### 進捗管理ファイルの作成と運用

1. **memo.log ファイルの作成**: プロジェクト開始時に以下の形式でファイルを作成する
   ```
   # プロジェクト進捗管理ログ
   開始日: YYYY-MM-DD
   目標: [具体的な完了目標]
   
   ## Phase 1: [フェーズ名] (優先度: 高)
   - [ ] タスク1の詳細説明
   - [ ] タスク2の詳細説明
   
   ## Phase 2: [フェーズ名] (優先度: 中)
   - [ ] タスク3の詳細説明
   
   ## 完了済みタスク
   - [x] 完了したタスク (完了日: YYYY-MM-DD)
   ```

2. **TodoWriteツールとの併用**: 
   - TodoWriteツール: リアルタイム進捗管理とステータス追跡
   - memo.log: タスク管理の詳細な要件とチェックリスト、完了履歴の永続化

3. **定期的な同期**: 各作業セッション後にmemo.logを更新し、TodoWriteツールの状態と整合性を保つ

### 進捗管理の実施タイミング

1. **プロジェクト開始時**: Discovery Phase完了後、memo.logファイルを作成
2. **セッション再開時**: **必ずmemo.logファイルを最初に読み込み、前回の状況を把握**
3. **各タスク開始前**: memo.logで要件を再確認し、TodoWriteツールで状態を更新
4. **各タスク完了後**: 両方のツールで完了をマーク、次のタスクの準備
5. **セッション終了時**: **必ずmemo.logを更新し、次回セッション用の情報を記録**

**重要**: memo.logファイルは作業継続性の要であり、セッション開始時の参照とセッション終了時の更新を怠ると、作業漏れや重複作業が発生します。

### 作業漏れチェックポイント

1. **中間検証**: 各フェーズ完了時に以下を確認
   - memo.logの全項目が完了しているか
   - TodoWriteツールの状態が正確か
   - 新たに発見した作業がないか

2. **最終検証**: プロジェクト完了前に以下を確認
   - すべてのファイルが存在するか
   - 品質基準を満たしているか
   - 参照整合性に問題がないか

この二重管理システム（TodoWriteツール + memo.log）により、作業漏れを完全に防止し、プロジェクトの確実な完了を保証します。

## 継続改善とベストプラクティス

タスク実行中に発見した改善点は**即座にCLAUDE.mdに追記**し、継続的にプロセスを改善してください：

### 改善記録の種類

1. **効率化手順**: より効率的な手順や方法
2. **ツール活用法**: 新しいツールの活用法や組み合わせ
3. **エラー回避**: エラー回避のためのチェックポイント
4. **品質向上**: 品質向上のためのベストプラクティス
5. **時間短縮**: 時間短縮につながる技術やコマンド
6. **プロセス改善**: 各プロジェクトの学びを次回のテンプレートに反映

### 改善の記録例

```
## 新発見のベストプラクティス (追加日: YYYY-MM-DD)
- 特定のファイル形式作成時は、Xツールを使うと効率が2倍向上
- Yコマンドを実行前にZの確認をすることでエラーを防止可能
- 複数ファイル作成時はAパターンで実行すると品質が向上
```

**重要**: 改善点を見つけたら「後で記録する」ではなく、**その場で即座に追記**すること。CLAUDE.mdは「生きたドキュメント」として継続的に改善し、次回以降の作業効率を向上させます。

## CLAUDE.mdドキュメント管理とリファクタリング方針

### 📋 継続的なドキュメント改善

CLAUDE.mdファイルは継続的に追記・改善されるため、定期的なリファクタリングが必要です。以下の方針に従って、わかりやすく実用的な資料として維持してください：

### 🔄 リファクタリングの実施タイミング

1. **追記時の即座リファクタリング**: 新しい情報を追記する際は、同時に以下を実行する
   - 関連する既存セクションとの重複排除
   - 情報の論理的な配置の最適化
   - セクション構造の見直しと調整

2. **定期的な全体リファクタリング**: 大きな変更後は包括的に見直しを実行する
   - セクション間の整合性確認
   - 古い情報の更新または削除
   - 新しいパターンやベストプラクティスの統合

### 📚 わかりやすい構造の原則

1. **階層化された情報設計**
   ```
   # 大分類（基本機能・プロセス別）
   ## 中分類（具体的な手順・ツール別）
   ### 小分類（詳細手順・実装例）
   ```

2. **実用性重視の配置**
   - **頻繁に使用される情報**: ドキュメント上部に配置
   - **詳細な実装例**: 各セクション内で具体例として配置
   - **エラー対策・注意事項**: 関連する手順の直後に配置

3. **視覚的なわかりやすさ**
   - **アイコン使用**: 📋 📊 🔧 ⚠️ ✅ 等で情報種別を明確化
   - **コードブロック**: 具体的なコマンドや設定例を明確に区別
   - **重要度表示**: **太字**、`コード`、> 引用を適切に使用

### 🎯 リファクタリング時の重点項目

1. **情報の統合と整理**
   - 類似情報の統合（重複排除）
   - 関連情報のグルーピング
   - 情報の粒度調整（概要→詳細の流れ）

2. **実用性の向上**
   - チェックリスト形式での手順明確化
   - 具体例の充実（コマンド例、設定例）
   - トラブルシューティング情報の整理

3. **メンテナンス性の確保**
   - セクション目次の更新
   - 日付情報の整理
   - 古い情報の適切な処理（更新または削除）

### 📋 リファクタリングチェックリスト

追記・修正時には以下を確認してください：

- [ ] 新しい情報が適切なセクションに配置されているか
- [ ] 既存情報との重複がないか
- [ ] セクション構造が論理的で理解しやすいか
- [ ] 具体例やコード例が十分に含まれているか
- [ ] 重要度に応じた視覚的表現が適切か
- [ ] 全体の情報量が適切か（過度に冗長でないか）

### 🔧 リファクタリング実行方法

**CLAUDE.mdに追記する際の必須手順:**

1. **新情報の追記** → 関連セクションに適切に配置
2. **即座の重複チェック** → 既存情報との整合性確認
3. **セクション構造の調整** → 必要に応じて見出しレベルや順序を最適化
4. **全体バランスの確認** → 情報量とわかりやすさのバランス調整
5. **実用性の検証** → 実際の作業で使いやすい形になっているか確認

**この方針により、CLAUDE.mdは常に「最新で実用的、かつわかりやすい」作業指示書として機能し続けます。**

## 📝 Q&A結果の自動ドキュメント化

技術的なQ&Aセッションや問題解決の結果は、以下のプロセスで自動的にドキュメント化してください：

### 🎯 対象となるQ&A

以下の条件を満たすQ&Aセッションは必ずドキュメント化する：

1. **技術的な課題解決**: AWS、インフラ、開発環境等の技術的な問題と解決策
2. **設定・構築手順**: 新しいツールやサービスの設定方法
3. **ベストプラクティス**: 運用上の考慮事項や推奨事項
4. **トラブルシューティング**: エラーや問題の原因と対処法
5. **複数の要素が関わる複雑な内容**: 複数のサービスやツールの組み合わせ

### 📋 自動ドキュメント化の手順

**Q&Aセッション完了時に必ず以下を実行する：**

1. **TIPSフォルダの確認・作成**
   ```bash
   # TIPSフォルダが存在しない場合は作成
   mkdir -p TIPS
   ```

2. **MDファイルの作成**
   - ファイル名: `{主要技術}-{主要内容}-{date}.md` 形式
   - 例: `aws-waf-cloudfront-cross-region-considerations.md`

3. **MDファイルの内容構成**
   ```markdown
   # タイトル（問題・課題の概要）
   
   ## 概要
   - 問題の背景と概要
   
   ## 課題・問題点
   - 具体的な課題や制約
   
   ## 解決策・対応方法
   - 推奨される対策
   - 実装例やコード例
   
   ## 考慮事項
   - 注意点や制限事項
   
   ## チェックリスト
   - 実装・確認時のポイント
   
   ## 関連リンク
   - 参考資料やドキュメント
   ```

4. **TIPSフォルダへの配置**
   ```bash
   # 作成したMDファイルをTIPSフォルダに移動
   mv {filename}.md TIPS/
   ```

### 🔧 自動化のポイント

**毎回必ず実行する作業:**

1. **セッション完了の判定**: 技術的なQ&Aが完了し、有用な情報が得られた場合
2. **即座の実行**: 「後で整理する」ではなく、Q&A完了直後に実行
3. **標準化された形式**: 上記のテンプレートに従って一貫性を保つ
4. **適切なファイル名**: 内容が分かりやすく、検索しやすい名前を設定

### 📁 TIPSフォルダの管理

**TIPSフォルダの構造:**
```
TIPS/
├── aws-waf-cloudfront-cross-region-considerations.md
├── kubernetes-ingress-ssl-setup.md
├── terraform-state-management-best-practices.md
└── ...
```

**管理方針:**
- **分類**: 技術分野や主要サービス別に整理
- **命名規則**: `{サービス/技術}-{内容}-{特徴}.md`
- **定期見直し**: 古い情報の更新や統合を定期的に実施

### ✅ 実行チェックリスト

Q&Aセッション完了時に確認：

- [ ] 技術的な内容で今後参考になる情報が含まれているか
- [ ] TIPSフォルダが存在するか（なければ作成）
- [ ] 適切なファイル名でMDファイルを作成したか
- [ ] 標準テンプレートに従って内容を整理したか
- [ ] TIPSフォルダにファイルを配置したか
- [ ] 必要に応じてCLAUDE.mdに改善点を追記したか

**重要**: この自動ドキュメント化プロセスにより、技術的な知見を継続的に蓄積し、将来の類似問題の迅速な解決を実現します。Q&Aセッションの価値を最大化するため、必ず実行してください。